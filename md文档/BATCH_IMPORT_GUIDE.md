# 车辆容量批量导入功能使用指南

## 📋 功能概述

车辆容量批量导入功能允许管理员通过Excel文件一次性导入多条车辆容量参考数据，提高数据录入效率。

## 🔧 接口信息

- **接口地址**: `POST /api/dispatch/vehicle-capacity/batch-import`
- **权限要求**: 区域调度员、超级管理员
- **支持格式**: Excel (.xlsx)
- **最大文件大小**: 10MB

## 📊 Excel模板格式

### 必需列
| 列名 | 数据类型 | 说明 | 示例 |
|------|----------|------|------|
| 车辆类型 | 字符串 | 必须为"单车"或"挂车" | 单车 |
| 标准容积 | 数值 | 单位：立方米，必须大于0 | 45.5 |
| 车牌号 | 字符串 | 唯一标识，自动转大写 | 京A12345 |

### 可选列
| 列名 | 数据类型 | 说明 | 示例 |
|------|----------|------|------|
| 供应商 | 字符串 | 多个供应商用英文逗号分隔 | 供应商A,供应商B |

### 示例Excel内容
```
车辆类型 | 标准容积 | 车牌号 | 供应商
单车     | 45.5    | 京A12345 | 供应商A,供应商B
挂车     | 68.0    | 沪B67890 | 供应商C
单车     | 42.0    | 粤C54321 | 供应商D,供应商E,供应商F
```

## 🚀 使用步骤

### 1. 准备Excel文件
1. 下载模板文件或按上述格式创建Excel文件
2. 确保数据格式正确
3. 保存为.xlsx格式

### 2. 登录系统
1. 访问系统登录页面
2. 使用区域调度员或超级管理员账号登录
3. 确保有相应的权限

### 3. 上传文件
1. 进入"车辆容量参考"模块
2. 点击"批量导入"按钮
3. 选择准备好的Excel文件
4. 点击"开始导入"

### 4. 查看结果
- 成功：显示导入成功的记录数量
- 失败：显示具体错误信息和失败记录
- 部分成功：显示成功和失败的数量

## 📋 返回结果说明

### 成功响应
```json
{
  "success": true,
  "data": {
    "message": "批量导入完成: 成功4条, 失败0条",
    "success_count": 4,
    "error_count": 0,
    "total_records": 4,
    "errors": []
  }
}
```

### 失败响应
```json
{
  "success": false,
  "error": {
    "code": 4001,
    "message": "数据验证失败",
    "details": [
      "第3行: 车辆类型不能为空",
      "第4行: 标准容积必须是正数"
    ]
  }
}
```

## ⚠️ 注意事项

1. **数据验证**
   - 车辆类型必须为"单车"或"挂车"
   - 标准容积必须大于0
   - 车牌号不能为空且会转换为大写

2. **重复处理**
   - 相同车牌号的数据会被更新
   - 不同车牌号的数据会被新增

3. **权限要求**
   - 必须具有区域调度员或超级管理员权限
   - 普通用户无法使用此功能

4. **文件要求**
   - 仅支持.xlsx格式
   - 文件大小不超过10MB
   - 建议一次导入不超过1000条记录

## 🔍 常见问题

### Q: 导入失败怎么办？
A: 检查Excel文件格式是否正确，查看具体的错误信息，修正后重新导入。

### Q: 如何更新已存在的数据？
A: 使用相同的车牌号重新导入，系统会自动更新对应记录。

### Q: 支持哪些车辆类型？
A: 目前仅支持"单车"和"挂车"两种类型。

### Q: 供应商字段如何填写？
A: 多个供应商用英文逗号分隔，如："供应商A,供应商B,供应商C"。

## 📞 技术支持

如有问题，请联系系统管理员或查看系统日志获取详细信息。