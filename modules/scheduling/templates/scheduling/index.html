{% extends 'base.html' %}

{% block title %}
智能调度模块 - 安徽XX智能运力系统
{% endblock %}

{% block extra_css %}
<style>
    .module-header {
        margin-bottom: 30px;
        padding-bottom: 15px;
        border-bottom: 1px solid #e4e7ed;
    }
    .function-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 30px;
    }
    .function-card {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    .btn {
        display: inline-block;
        padding: 8px 16px;
        background-color: #4a6cf7;
        color: white;
        text-decoration: none;
        border-radius: 4px;
        margin-top: 10px;
    }
    .btn:hover {
        background-color: #3a5de7;
    }
</style>
{% endblock %}

{% block content %}
<div class="module-header">
    <h2>智能调度模块</h2>
</div>
<div class="function-cards">
    <div class="function-card">
        <h3><i class="fas fa-truck"></i> 车辆管理</h3>
        <p>管理所有运输车辆信息，包括状态、位置和维护记录。</p>
        <a href="{{ url_for('scheduling_bp.vehicle_management') }}" class="btn">进入</a>
    </div>
    <div class="function-card">
        <h3><i class="fas fa-tasks"></i> 任务管理</h3>
        <p>查看和管理所有运输任务流程。</p>
        <a href="{{ url_for('scheduling_bp.task_management') }}" class="btn">进入</a>
    </div>
    <div class="function-card">
        <h3><i class="fas fa-user-cog"></i> 人工派车</h3>
        <p>人工调度车辆，灵活处理特殊运输需求和紧急情况。</p>
        <a href="{{ url_for('scheduling_bp.manual_dispatch') }}" class="btn">进入</a>
    </div>
</div>

<div style="margin-top: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
    <h5><i class="fas fa-info-circle"></i> 权限说明</h5>
    <ul style="margin-top: 10px; margin-bottom: 0;">
        {% set user_roles = current_user.roles if current_user.roles else [] %}
        {% if '超级管理员' in user_roles or '区域调度员' in user_roles %}
        <li><strong>您当前角色：</strong>{{ user_roles | join(', ') }} - 可直接进行人工派车操作</li>
        {% elif '车间地调' in user_roles %}
        <li><strong>您当前角色：</strong>车间地调 - 可提交车辆需求申请，由调度中心统一安排</li>
        {% else %}
        <li><strong>您当前角色：</strong>{{ user_roles | join(', ') if user_roles else '未分配角色' }} - 无人工派车权限</li>
        {% endif %}
    </ul>
</div>
{% endblock %}